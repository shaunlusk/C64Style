<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
  <title>C64Style Mouse Event Demo</title>
  <script type="text/javascript" src="../node_modules/slcommon/Event.js"></script>
  <script type="text/javascript" src="../node_modules/slcommon/EventNotifierMixin.js"></script>
  <script type="text/javascript" src="../node_modules/slcommon/Utils.js"></script>
  <script type="text/javascript" src="../node_modules/slcommon/LinkedList.js"></script>
  <script type="text/javascript" src="../node_modules/slcommon/MixinTemplate.js"></script>
  <script type="text/javascript" src="../node_modules/slcommon/Queue.js"></script>
  <script type="text/javascript" src="../node_modules/slcommon/PriorityQueue.js"></script>
  <script type="text/javascript" src="../node_modules/slcommon/UniquePriorityQueue.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/Utils.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/EventTypes.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/CanvasContextWrapper.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/Layer.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/GfxElement.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/GfxElementZIndexComparable.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/GfxLayer.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/ImageElement.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/ImageLoader.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/ImageRenderer.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/SpriteAnimationFrame.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/Sprite.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/ImageSpriteFrame.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/ImageSprite.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/LayerFactory.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/MoveOrder.js"></script>
  <script type="text/javascript" src="../node_modules/slgfx/Screen.js"></script>
  <script type="text/javascript" src="../lib/SlImport.js"></script>
  <script type="text/javascript" src="../lib/Common/Utils.js"></script>
  <script type="text/javascript" src="../lib/Constants.js"></script>
  <script type="text/javascript" src="../lib/Color.js"></script>
  <script type="text/javascript" src="../lib/CharacterMap.js"></script>
  <script type="text/javascript" src="../lib/ColorPointer.js"></script>
  <script type="text/javascript" src="../lib/PixPathTypes.js"></script>
  <script type="text/javascript" src="../lib/LayerFactory.js"></script>
  <script type="text/javascript" src="../lib/CharacterRenderer.js"></script>
  <script type="text/javascript" src="../lib/PixRenderer.js"></script>
  <script type="text/javascript" src="../lib/PixElement.js"></script>
  <script type="text/javascript" src="../lib/PixSprite.js"></script>
  <script type="text/javascript" src="../lib/TextElement.js"></script>
  <script type="text/javascript" src="../lib/TextLink.js"></script>
  <script type="text/javascript" src="../lib/TextButton.js"></script>
  <script type="text/javascript" src="../lib/TextPrompt.js"></script>
  <script type="text/javascript" src="../lib/TextLayer.js"></script>
  <script type="text/javascript" src="../lib/Screen.js"></script>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
  <div id="content">
  </div>
  <div id="buttons"><button onclick="screen.setPaused(!screen.isPaused());">Pause</button></div>
  <div id="info"></div>
  <div id="backLinks">
    <a href="index.html">Back to Demos Index</a><br /><br />
    <a href="../index.html">Back to Main Index</a>
  </div>
  <script type="text/javascript">
  var C64Style = C64Style || {};
  var screen = null,
    textLayer = null,
    gfxLayer = null,
    pixPathArray1 = [{"type":"PIXEL","x":3,"y":0,"color":"#A0A0FF"},{"type":"PIXEL","x":4,"y":0,"color":"#A0A0FF"},{"type":"PIXEL","x":2,"y":1,"color":"#A0A0FF"},{"type":"PIXEL","x":3,"y":1,"color":"#A0A0FF"},{"type":"PIXEL","x":4,"y":1,"color":"#A0A0FF"},{"type":"PIXEL","x":5,"y":1,"color":"#A0A0FF"},{"type":"PIXEL","x":1,"y":2,"color":"#A0A0FF"},{"type":"PIXEL","x":2,"y":2,"color":"#A0A0FF"},{"type":"PIXEL","x":5,"y":2,"color":"#A0A0FF"},{"type":"PIXEL","x":6,"y":2,"color":"#A0A0FF"},{"type":"PIXEL","x":0,"y":3,"color":"#A0A0FF"},{"type":"PIXEL","x":1,"y":3,"color":"#A0A0FF"},{"type":"PIXEL","x":6,"y":3,"color":"#A0A0FF"},{"type":"PIXEL","x":7,"y":3,"color":"#A0A0FF"},{"type":"PIXEL","x":0,"y":4,"color":"#A0A0FF"},{"type":"PIXEL","x":1,"y":4,"color":"#A0A0FF"},{"type":"PIXEL","x":6,"y":4,"color":"#A0A0FF"},{"type":"PIXEL","x":7,"y":4,"color":"#A0A0FF"},{"type":"PIXEL","x":1,"y":5,"color":"#A0A0FF"},{"type":"PIXEL","x":2,"y":5,"color":"#A0A0FF"},{"type":"PIXEL","x":5,"y":5,"color":"#A0A0FF"},{"type":"PIXEL","x":6,"y":5,"color":"#A0A0FF"},{"type":"PIXEL","x":2,"y":6,"color":"#A0A0FF"},{"type":"PIXEL","x":3,"y":6,"color":"#A0A0FF"},{"type":"PIXEL","x":4,"y":6,"color":"#A0A0FF"},{"type":"PIXEL","x":5,"y":6,"color":"#A0A0FF"},{"type":"PIXEL","x":3,"y":7,"color":"#A0A0FF"},{"type":"PIXEL","x":4,"y":7,"color":"#A0A0FF"}],
    pixPathArray2 = [{"type":"PIXEL","x":3,"y":0,"color":"#A0A0FF"},{"type":"PIXEL","x":4,"y":0,"color":"#A0A0FF"},{"type":"PIXEL","x":2,"y":1,"color":"#A0A0FF"},{"type":"PIXEL","x":3,"y":1,"color":"#A0A0FF"},{"type":"PIXEL","x":4,"y":1,"color":"#A0A0FF"},{"type":"PIXEL","x":5,"y":1,"color":"#A0A0FF"},{"type":"PIXEL","x":1,"y":2,"color":"#A0A0FF"},{"type":"PIXEL","x":2,"y":2,"color":"#A0A0FF"},{"type":"PIXEL","x":5,"y":2,"color":"#A0A0FF"},{"type":"PIXEL","x":6,"y":2,"color":"#A0A0FF"},{"type":"PIXEL","x":0,"y":3,"color":"#A0A0FF"},{"type":"PIXEL","x":1,"y":3,"color":"#A0A0FF"},{"type":"PIXEL","x":3,"y":3,"color":"#A0FFA0"},{"type":"PIXEL","x":4,"y":3,"color":"#A0FFA0"},{"type":"PIXEL","x":6,"y":3,"color":"#A0A0FF"},{"type":"PIXEL","x":7,"y":3,"color":"#A0A0FF"},{"type":"PIXEL","x":0,"y":4,"color":"#A0A0FF"},{"type":"PIXEL","x":1,"y":4,"color":"#A0A0FF"},{"type":"PIXEL","x":3,"y":4,"color":"#A0FFA0"},{"type":"PIXEL","x":4,"y":4,"color":"#A0FFA0"},{"type":"PIXEL","x":6,"y":4,"color":"#A0A0FF"},{"type":"PIXEL","x":7,"y":4,"color":"#A0A0FF"},{"type":"PIXEL","x":1,"y":5,"color":"#A0A0FF"},{"type":"PIXEL","x":2,"y":5,"color":"#A0A0FF"},{"type":"PIXEL","x":5,"y":5,"color":"#A0A0FF"},{"type":"PIXEL","x":6,"y":5,"color":"#A0A0FF"},{"type":"PIXEL","x":2,"y":6,"color":"#A0A0FF"},{"type":"PIXEL","x":3,"y":6,"color":"#A0A0FF"},{"type":"PIXEL","x":4,"y":6,"color":"#A0A0FF"},{"type":"PIXEL","x":5,"y":6,"color":"#A0A0FF"},{"type":"PIXEL","x":3,"y":7,"color":"#A0A0FF"},{"type":"PIXEL","x":4,"y":7,"color":"#A0A0FF"}],
    pixPathArray3 = [{"type":"PIXEL","x":3,"y":0,"color":"#60FFFF"},{"type":"PIXEL","x":4,"y":0,"color":"#60FFFF"},{"type":"PIXEL","x":2,"y":1,"color":"#60FFFF"},{"type":"PIXEL","x":3,"y":1,"color":"#60FFFF"},{"type":"PIXEL","x":4,"y":1,"color":"#60FFFF"},{"type":"PIXEL","x":5,"y":1,"color":"#60FFFF"},{"type":"PIXEL","x":1,"y":2,"color":"#60FFFF"},{"type":"PIXEL","x":2,"y":2,"color":"#60FFFF"},{"type":"PIXEL","x":5,"y":2,"color":"#60FFFF"},{"type":"PIXEL","x":6,"y":2,"color":"#60FFFF"},{"type":"PIXEL","x":0,"y":3,"color":"#60FFFF"},{"type":"PIXEL","x":1,"y":3,"color":"#60FFFF"},{"type":"PIXEL","x":6,"y":3,"color":"#60FFFF"},{"type":"PIXEL","x":7,"y":3,"color":"#60FFFF"},{"type":"PIXEL","x":0,"y":4,"color":"#60FFFF"},{"type":"PIXEL","x":1,"y":4,"color":"#60FFFF"},{"type":"PIXEL","x":6,"y":4,"color":"#60FFFF"},{"type":"PIXEL","x":7,"y":4,"color":"#60FFFF"},{"type":"PIXEL","x":1,"y":5,"color":"#60FFFF"},{"type":"PIXEL","x":2,"y":5,"color":"#60FFFF"},{"type":"PIXEL","x":5,"y":5,"color":"#60FFFF"},{"type":"PIXEL","x":6,"y":5,"color":"#60FFFF"},{"type":"PIXEL","x":2,"y":6,"color":"#60FFFF"},{"type":"PIXEL","x":3,"y":6,"color":"#60FFFF"},{"type":"PIXEL","x":4,"y":6,"color":"#60FFFF"},{"type":"PIXEL","x":5,"y":6,"color":"#60FFFF"},{"type":"PIXEL","x":3,"y":7,"color":"#60FFFF"},{"type":"PIXEL","x":4,"y":7,"color":"#60FFFF"}],
    pixPathArray4 = [{"type":"PIXEL","x":3,"y":0,"color":"#60FFFF"},{"type":"PIXEL","x":4,"y":0,"color":"#60FFFF"},{"type":"PIXEL","x":2,"y":1,"color":"#60FFFF"},{"type":"PIXEL","x":3,"y":1,"color":"#60FFFF"},{"type":"PIXEL","x":4,"y":1,"color":"#60FFFF"},{"type":"PIXEL","x":5,"y":1,"color":"#60FFFF"},{"type":"PIXEL","x":1,"y":2,"color":"#60FFFF"},{"type":"PIXEL","x":2,"y":2,"color":"#60FFFF"},{"type":"PIXEL","x":5,"y":2,"color":"#60FFFF"},{"type":"PIXEL","x":6,"y":2,"color":"#60FFFF"},{"type":"PIXEL","x":0,"y":3,"color":"#60FFFF"},{"type":"PIXEL","x":1,"y":3,"color":"#60FFFF"},{"type":"PIXEL","x":3,"y":3,"color":C64Style.Color.RED},{"type":"PIXEL","x":4,"y":3,"color":C64Style.Color.RED},{"type":"PIXEL","x":6,"y":3,"color":"#60FFFF"},{"type":"PIXEL","x":7,"y":3,"color":"#60FFFF"},{"type":"PIXEL","x":0,"y":4,"color":"#60FFFF"},{"type":"PIXEL","x":1,"y":4,"color":"#60FFFF"},{"type":"PIXEL","x":3,"y":4,"color":C64Style.Color.RED},{"type":"PIXEL","x":4,"y":4,"color":C64Style.Color.RED},{"type":"PIXEL","x":6,"y":4,"color":"#60FFFF"},{"type":"PIXEL","x":7,"y":4,"color":"#60FFFF"},{"type":"PIXEL","x":1,"y":5,"color":"#60FFFF"},{"type":"PIXEL","x":2,"y":5,"color":"#60FFFF"},{"type":"PIXEL","x":5,"y":5,"color":"#60FFFF"},{"type":"PIXEL","x":6,"y":5,"color":"#60FFFF"},{"type":"PIXEL","x":2,"y":6,"color":"#60FFFF"},{"type":"PIXEL","x":3,"y":6,"color":"#60FFFF"},{"type":"PIXEL","x":4,"y":6,"color":"#60FFFF"},{"type":"PIXEL","x":5,"y":6,"color":"#60FFFF"},{"type":"PIXEL","x":3,"y":7,"color":"#60FFFF"},{"type":"PIXEL","x":4,"y":7,"color":"#60FFFF"}],
    sprite1 = null,
    sprite2 = null,
    element = null,
    xOffset = null,
    yOffset = null,
    dragOn;
  var config = {
    "rows" : 25,
    "cols" : 40,
    "scaleX" : 1,
    "scaleY" : 1,
    "fpsElem" : document.getElementById('info')
  };

  function initialize(targetDiv, config) {
    screen = new C64Style.C64Screen(targetDiv, new C64Style.LayerFactory(), config);

    screen.initialize();
    textLayer = screen.createLayer("TextLayer");
    textLayer.writeText("Try clicking and dragging", 4,1,C64Style.Color.LIGHTBLUE);
    textLayer.writeText("the PixSprite.", 4,2,C64Style.Color.LIGHTBLUE);

    textLayer.writeText("Mouse X:", 1,19,C64Style.Color.LIGHTBLUE);
    textLayer.writeText("Mouse Y:", 1,20,C64Style.Color.LIGHTBLUE);
    textLayer.writeText("Mouse Column:", 1,21,C64Style.Color.LIGHTBLUE);
    textLayer.writeText("Mouse Row:", 1,22,C64Style.Color.LIGHTBLUE);
    textLayer.writeText("Mouse Over Element?", 1,23,C64Style.Color.LIGHTBLUE);

    gfxLayer = screen.createLayer("GfxLayer");

    sprite1 = new C64Style.PixSprite(screen, gfxLayer, {
      x:10, y:10,
      scaleX:2, scaleY:2,
      frames:[
        new C64Style.PixSpriteFrame({pixArray:pixPathArray1, duration:400}),
        new C64Style.PixSpriteFrame({pixArray:pixPathArray2, duration:400}),
      ]
    });
    sprite2 = new C64Style.PixSprite(screen, gfxLayer, {
      x:10, y:10,
      scaleX:2, scaleY:2,
      hidden:true,
      frames:[
        new C64Style.PixSpriteFrame({pixArray:pixPathArray3, duration:400}),
        new C64Style.PixSpriteFrame({pixArray:pixPathArray4, duration:400}),
      ]
    });
    gfxLayer.addElement(sprite1);
    gfxLayer.addElement(sprite2);

    screen.on(SL.EventType.MOUSE_DOWN_ON_ELEMENT, function(event) {
      dragOn = true;
      xOffset = event.data.x - sprite1.getX();
      yOffset = event.data.y - sprite1.getY();
      sprite1.hide();
      sprite2.show();
    });
    screen.on(SL.EventType.MOUSE_UP, function(event) {
      dragOn = false;
    });
    screen.on(SL.EventType.MOUSE_UP_ON_ELEMENT, function(event) {
      dragOn = false;
      sprite2.hide();
      sprite1.show();
    });
    screen.on(SL.EventType.MOUSE_MOVE, function(event) {
      updateMouseStats(event);
      if (dragOn) {
        sprite2.setX(event.data.x - xOffset);
        sprite2.setY(event.data.y - yOffset);
        sprite1.setX(event.data.x - xOffset);
        sprite1.setY(event.data.y - yOffset);
      }
    });

    screen.render(1);
  }

  function updateMouseStats(event) {
    textLayer.clearLength(15,19,4);
    textLayer.writeText(event.data.x.toString(), 15,19,C64Style.Color.LIGHTGREEN);
    textLayer.clearLength(15,20,4);
    textLayer.writeText(event.data.y.toString(), 15,20,C64Style.Color.LIGHTGREEN);
    textLayer.clearLength(15,21,4);
    textLayer.writeText(event.data.col.toString(), 15,21,C64Style.Color.LIGHTGREEN);
    textLayer.clearLength(15,22,4);
    textLayer.writeText(event.data.row.toString(), 15,22,C64Style.Color.LIGHTGREEN);
    textLayer.clearLength(21,23,6);
    var mouseIsOver = sprite1.collidesWithCoordinates(event.data.x, event.data.y);
    textLayer.writeText(mouseIsOver.toString(), 21,23,C64Style.Color.LIGHTGREEN);
  }

  initialize(document.getElementById("content"), config);
  </script>
</body>
</html>
